# ExcelShopSync

![License](https://img.shields.io/github/license/FreidFry/ExcelShopSync?style=square&color=brightgreen&cacheSeconds=3600)
![GitHub release (latest by date)](https://img.shields.io/github/v/release/FreidFry/ExcelShopSync?style=square&color=brightgreen&cacheSeconds=3600)  

#### Інші мови  
- [English](README.md)
- [Русский](README_ru.md)

Ця програма створена для спрощення та часткової автоматизації процесу оновлення прайс-листів та наявності товарів на маркетплейсах та в інтернет-магазинах. З її допомогою можна швидко та ефективно синхронізувати дані між різними джерелами, мінімізуючи ручну працю та знижуючи ймовірність людських помилок.

### Наданий функціонал дозволяє:
- Переносити за артикулами:
    - ціни на продукт
    - наявність та кількість продукту
    - знижки (з датами та без)
    - статуси товарів (наприклад, "Готово до відправки")
- Збільшувати ціни на певний процент.
- Вказувати зв'язки за різними артикулами до товару.
- Працювати з декількома файлами одночасно.

---

## Інструкція по роботі з програмою

Програма призначена для обробки даних з файлів Excel — синхронізації цін, наявності, знижок та інших параметрів між прайс-листами та маркетплейсами.

⚠️ **Важливо:** Програма працює **за артикулами**, повне збіг обов'язкове за умови що не вказано зв'язок. Навіть різниця в одному символі (наприклад, `K` та `К`) критична.

---

## Передмова:
- Рекомендується створювати резервні копії файлів перед обробкою.
- Програма не підтримує макроси та складні формули у файлах Excel.
- Обробка великих файлів може зайняти певний час, будьте терплячими.
- Програма не призначена для обробки файлів із захистом паролем.
- При виникненні проблем чи питань, будь ласка, звертайтеся за контактами в кінці інструкції.

### Рекомендації перед початком

- Дотримуйтесь інструкцій, зазначених нижче.
- Усі файли Excel повинні бути **закриті** перед запуском обробки.
- Використовуйте файли у форматах: `.xlsx`, `.xls`.
- При виникненні помилок - перевірте правильність заголовків та наявність усіх необхідних колонок.

---

#### Опис подальших термінів:
- **Target** — файл(и), в які будуть вноситися зміни.
- **Source** — файл(и), з яких будуть братися дані для змін.
- **Артикул** — унікальний ідентифікатор товару, за яким відбувається співставлення між Target та Source.
- **Прайс** — файл Source, що містить актуальні ціни на товари.

- **Обов'язкові поля** — колонки, які повинні бути присутніми у файлах для коректної роботи програми.
- **Додаткові поля** — колонки, які можуть бути використані для розширеного функціоналу, але не є обов'язковими.

---

## Використання

<details>
<summary>Головне вікно</summary>

### 1. Завантаження Target файлів
- Кнопка: **Додати файл для змін**
- Використовуються для внесення змін.

### 2. Завантаження Source файлів
- Кнопка: **Додати файл джерело**
- Використовуються як джерела даних.

> **Рекомендація:** використовуйте як Source файли мінімальну кількість файлів з дубльованими артикулами, щоб уникнути конфліктів.
> - **Причина:** якщо один і той же артикул зустрічається у кількох Source файлах, буде використано значення з першого знайденого продукту з цим артикулом.

> **Порада:** якщо у вас кілька прайсів **З ОДНАКОВИМИ ТОВАРАМИ**, об'єднайте їх в один файл перед обробкою щоб отримати очікуваний результат.
> - Якщо у вас немає збігів артикулів між файлами, то можете використовувати кілька Source файлів.

---

## Вибір операцій

### Перенесення цін
- **Прапорець:** `Перенести ціни`
#### Обов'язкові поля:
- `Article`, `Price`
- Додатково: `ArticleComplect`, `PriceComplect` (у прайсі)

> **Обов'язково:** якщо ви переносите значення з прайсу, то значення повинні бути **під відповідними колонками**.

---
### Перенесення наявності
- **Прапорець:** `Перенести наявність`
#### Обов'язкові поля:
- `Availability`
- Додатково: `Availability Complect` (у прайсі)

---

### Збільшення ціни
- **Прапорець:** `Збільшити ціну (фальш знижка)`
- Вказати процент націнки в межах від `1` до `200`.

> **Детально:** Сприймається як процент. 1 == 101%, 2 == 102%, 99 == 199%, 100 == 100%, 101 == 101%... 200 == 200%, 201 == 201%...  
> при введенні `0` або `100` - ціна не зміниться.

> **Підказка:** якщо ви хочете збільшити ціну на 10%, введіть `10` або `110`. Але якщо ви введете більше 200 - у вас попросять підтвердження.

---

### Перенесення знижок
- **Прапорець:** `Перенести знижку`
#### Обов'язкові поля:
- `Знижка` (лише з магазину в магазин)

> **Важливо:** перенесення % знижок працює таким чином, що він **не перетворює 110% в 10%**, а просто **копіює значення з однієї колонки в іншу.** Будьте уважні при використанні.

---

### Перенесення дати знижок
- **Прапорець:** `Перенести дату знижки`
#### Додаткові поля:
- `знижка від/до` (лише з магазину в магазин)

> **обов'язково:** В налаштуваннях магазину мають бути вказані колонки `Формат дати`.  
> `Дата кінця знижки` та `Дата початку знижки` використовуються лише при їх наявності в магазині.  
> Фактично немає такого поля "Дата знижки". Береться дата з колонки одного магазину та переноситься в колонку іншого магазину якщо вона присутня.

---

### Пошук відсутніх артикулів
- **Прапорець:** `Знайти відсутні`
- Дозволяє знайти артикули, які є в Target файлах, але відсутні в Source файлах.
- Результат зберігається у файл `missing.txt` на робочому столі.

---

### Запуск
- Кнопка: **Старт**
1. Переконайтеся, що файли завантажені
2. Встановіть параметри
3. Натисніть "Старт"
4. Дочекайтеся повідомлення `Done`

---

## Обов'язкові умови

- Назви колонок мають бути коректними (Якщо прайс-лист):
    - **Артикул:** `Article`, `Артикул`, `ArticleComplect`
    - **Ціна:** `Price`, `Ціна`, `Price Complect`
    - **Наявність:** `Availability`, `Наличие`, `Availability Complect`

❗Усі заголовки мають бути написані **точно**, без зайвих символів, відступів та помилок.

</details>

<details>
<summary> Менеджер магазинів </summary>

### Відкриття менеджера магазинів
- `Налаштування` -> `Менеджер магазинів`

### Опис вікна
- **Зліва** список магазинів з можливістю вибору для редагування. (Можна видалити непотрібні магазини)
- **Кнопка зліва-внизу** Дозволяє додавати магазини.
- **Справа** список доступних колонок з завантаженого файлу.
- **Центр** Поля для назв колонок, що відповідають різним параметрам (значення беруться з колонки справа).

> **Обов'язково:** оскільки зі списку справа (Усі колонки) програма використовує для визначення магазину - залиште лише ті колонки, які є у вашому файлі та є ЗАВЖДИ В КОЖНОМУ ФАЙЛІ.  
> Колонки які залежать від категорії товару (наприклад, `колір`, `розмір`, `матеріал`, `матеріал|45234` тощо) - будуть заважати нормальній роботі, тому їх потрібно видалити зі списку.

### Призначення
- Дозволяє зберігати налаштування колонок для різних магазинів.
- Можна додавати, видаляти та редагувати магазини.

> **Зверніть увагу:** При збереженні, **зміни будуть доступні при наступному запуску програми.**

### Додавання магазину
- Кнопка: `Додати магазин`
- Введіть ім'я магазину.
- Натисніть кнопку `Отримати заголовки магазинів`
- Вкажіть назви колонок для артикулу, ціни, наявності та інших параметрів які є в магазині.

</details>

<details>
<summary>Таблиця зв'язків продуктів</summary>

### Відкриття таблиці зв'язків
- `Таблиця зв'язків продуктів`

### Опис вікна
- **Кнопка: `Додати новий продукт`**
- Таблиця з колонками:
> **Master** - основний артикул продукту, до якого будуть прив'язані інші артикули. **(артикул з прайсу)**  
> **Пов'язаний артикул** - артикул, який буде пов'язаний з основним. **(артикул з магазину)** Назва колонки - магазин в якому цей артикул використовується.

> **Увага:** якщо у вас кілька магазинів, то для кожного магазину має бути свій стовпець з назвою магазину.  
> Якщо у вас артикул в магазині збігається з артикулом в прайсі - не потрібно додавати зв'язок.
> Якщо у вас в конкретному магазині артикул збігається з артикулом в прайсі - додавайте зв'язки лише для тих магазинів, в яких артикул відрізняється. (але за бажанням можете додати для всіх магазинів)

</details>

---

## Приклади

### 1 приклад

✅ Правильний вигляд:

| Article | Price | Article Complect | Price Complect |
 |---------|-------|------------------|----------------|
| A001    | 100   | A001-C           | 80             |

❌ Помилка:

| Артикул | Article | Ціна |
 |---------|---------|------|
| A001    |         | 100  |

> В цьому випадку буде оброблена лише колонка `Article`. А оскільки в ній немає значення
>     - товар не буде знайдений та оброблений.

### 2 приклад

✅ Правильний вигляд:

| Article  | Price    | Availability | any | any   | any |
 |----------|----------|--------------|-----|-------|-----|
| Product1 | 200      | +            | ... | ...   | ... |
| any      | Article  | Availability | any | Price | any |
| ...      | product2 | +            | ... | 300   | ... |
| ...      | product3 | +            | ... | 700   | ... |

❌ Помилка:

| Article  | Price    | Availability | any | any   | any |
 |----------|----------|--------------|-----|-------|-----|
| Product1 | 200      | +            | ... | ...   | ... |
| any      | Article  | Availability | any | Price | any |
| ...      | product2 | +            | ... | 300   | ... |
| product3 | 700      | +            | ... | ...   | ... |

> На виході буде -> Товар1 з ціною 200 в наявності, Товар2 з ціною 300 в наявності, товар3 - ігнор

### Більш детально в інструкції яка знаходиться в додатку.
`Більше` -> `Інструкція`

---

## Повторення важливих моментів

<details>
<summary>Загальне</summary>

> - Перевіряйте результати після обробки.

> - Дотримуйтесь інструкцій, зазначених нижче.

> - Усі файли Excel повинні бути **закриті** перед запуском обробки.

> - Використовуйте файли у форматах: `.xlsx`, `.xls`.

> - При виникненні помилок - перевірте правильність заголовків та наявність усіх необхідних колонок.

> - Програма працює **за артикулами**, повне збіг обов'язкове за умови що не вказано зв'язок. Навіть різниця в одному символі (наприклад, `K` та `К`) критична.

> - Рекомендується створювати резервні копії файлів перед обробкою.

> - Програма не підтримує макроси та складні формули у файлах Excel.

> - Обробка великих файлів може зайняти певний час, будьте терплячими.

</details>

<details>
<summary> Операції </summary>

> **Рекомендація:** використовуйте як Source файли мінімальну кількість файлів з дубльованими артикулами, щоб уникнути конфліктів.
> - **Причина:** якщо один і той же артикул зустрічається у кількох Source файлах, буде використано значення з першого знайденого продукту з цим артикулом.

> **Порада:** якщо у вас кілька прайсів **З ОДНАКОВИМИ ТОВАРАМИ**, об'єднайте їх в один файл перед обробкою щоб отримати очікуваний результат.
> - Якщо у вас немає збігів артикулів між файлами, то можете використовувати кілька Source файлів.

> **Обов'язково:** якщо ви переносите значення з прайсу, то значення повинні бути **під відповідними колонками**. (актуально для прайсів, магазини зазвичай і так дотримуються стандарту)

### Збільшенні ціни
> **Детально:** Сприймається як процент. 1 == 101%, 2 == 102%, 99 == 199%, 100 == 100%, 101 == 101%... 200 == 200%, 201 == 201%...  
> при введенні `0` або `100` - ціна не зміниться.

> **Підказка:** якщо ви хочете збільшити ціну на 10%, введіть `10` або `110`. Але якщо ви введете більше 200 - у вас попросять підтвердження.

### Перенесення знижок

> **Важливо:** перенесення % знижок працює таким чином, що він **не перетворює 110% в 10%**, а просто **копіює значення з однієї колонки в іншу.** Будьте уважні при використанні.

### Перенесення дати знижок
> **обов'язково:** В налаштуваннях магазину мають бути вказані колонки `Формат дати`.  
> `Дата кінця знижки` та `Дата початку знижки` використовуються лише при їх наявності в магазині.  
> Фактично немає такого поля "Дата знижки". Береться дата з колонки одного магазину та переноситься в колонку іншого магазину якщо вона присутня.

</details>

<details>
<summary>Менеджер магазинів</summary>

> **Обов'язково:** оскільки зі списку справа (Усі колонки) програма використовує для визначення магазину - залиште лише ті колонки, які є у вашому файлі та є ЗАВЖДИ В КОЖНОМУ ФАЙЛІ.  
> Колонки які залежать від категорії товару (наприклад, `колір`, `розмір`, `матеріал`, `матеріал|45234` тощо) - будуть заважати нормальній роботі, тому їх потрібно видалити зі списку.

</details>

<details>
<summary>Таблиця зв'язків продуктів</summary>

> **Увага:** якщо у вас кілька магазинів, то для кожного магазину має бути свій стовпець з назвою магазину.  
> Якщо у вас артикул в магазині збігається з артикулом в прайсі - не потрібно додавати зв'язок.
> Якщо у вас в конкретному магазині артикул збігається з артикулом в прайсі - додавайте зв'язки лише для тих магазинів, в яких артикул відрізняється. (але за бажанням можете додати для всіх магазинів)

</details>

---

## Контакти

Виникли питання/пропозиції?  
Пишіть на:  
[Telegram](https://t.me/Freid4)  
[Пошта](mailto:f4labs.study@gmail.com)

---

# Відмова від відповідальності:
Використання цієї програми здійснюється на ваш власний ризик. Автор не несе відповідальності за будь-які збитки або пошкодження, що виникли в результаті використання програми. Будь-які помилки або проблеми, що виникли в процесі використання програми, не можуть бути пред'явлені авторові як претензії або вимоги про компенсацію. Більш того, автор не гарантує, що програма працюватиме без збоїв або помилок, і не несе відповідальності за будь-які наслідки, що виникли в результаті використання програми. Помилки в програмі можуть бути виправлені в майбутніх версіях, але автор не зобов'язується надавати підтримку або оновлення для програми. Користувачі повинні самостійно оцінювати ризики та вживати запобіжних заходів при використанні програми. Будь-які помилки пов'язані з неправильними результатами є результатом вашої неуважності та не можуть бути використані проти автора.