<h3 align="center">ExcelShopSync</h3>

<div align="center">
    <a href="./LICENSE"><img src="https://img.shields.io/github/license/FreidFry/ExcelShopSync?label=License&color=brightgreen&cacheSeconds=3600" alt="License"/></a>
    <a href="http://github.com/FreidFry/ExcelShopSync/releases/latest"><img src="https://img.shields.io/github/v/release/FreidFry/ExcelShopSync?style=square&color=brightgreen&cacheSeconds=3600" alt="Release"/></a>
</div>

#### Другие языки
- [Українська](README_ua.md)
- [Русский](README_ru.md)

Конечно, вот перевод текста на русский язык с сохранением всего форматирования Markdown.

---

Эта программа предназначена для упрощения и частичной автоматизации процесса обновления прайс-листов и наличия товаров на маркетплейсах и в интернет-магазинах. Она помогает быстро и эффективно синхронизировать данные между различными источниками, минимизируя ручной труд и снижая вероятность человеческих ошибок.

### Предоставляемый функционал позволяет:
- Переносить по артикулам:
    - Цены товаров
    - Наличие и количество товаров
    - Скидки (с датами и без)
    - Статусы товаров (например, «Готов к отгрузке»)
- Повышать цены на определенный процент.
- Указывать ссылки для разных артикулов на товар.
- Работать с несколькими файлами одновременно.

---

## Инструкция по использованию программы

Программа предназначена для обработки данных из файлов Excel — синхронизации цен, наличия, скидок и других параметров между прайс-листами и маркетплейсами.

⚠️ **Важно:** Программа работает **по артикулам**, обязательное точное совпадение, если не указана связь. Даже разница в один символ (например, `K` и `К`) критична.

---

## Предисловие:
- Рекомендуется создавать резервные копии файлов перед обработкой.
- Программа не поддерживает макросы и сложные формулы в файлах Excel.
- Обработка больших файлов может занять некоторое время, пожалуйста, наберитесь терпения.
- Программа не предназначена для обработки защищенных паролем файлов.
- Если вы столкнулись с проблемами или у вас есть вопросы, пожалуйста, обратитесь к контактам в конце инструкции.

### Рекомендации перед началом работы

- Следуйте инструкциям ниже.
- Все файлы Excel должны быть **закрыты** перед началом обработки.
- Используйте файлы в форматах: `.xlsx`, `.xls`.
- При возникновении ошибок проверьте правильность заголовков и наличие всех необходимых столбцов.

---

#### Описание последующих терминов:
- **Целевой файл (Target)** — файл(ы), в которые будут вноситься изменения.
- **Источник (Source)** — файл(ы), из которых будут браться данные для изменений.
- **Артикул (Article Number)** — уникальный идентификатор товара, используемый для сопоставления между Целевым файлом и Источником.
- **Прайс-лист (Price List)** — файл-Источник, содержащий актуальные цены на товары.

- **Обязательные поля (Required fields)** — столбцы, которые должны присутствовать в файлах для корректной работы программы.
- **Дополнительные поля (Additional fields)** — столбцы, которые можно использовать для расширенного функционала, но которые не являются обязательными.

---

## Использование

<details>
<summary>Главное окно</summary>

### 1. Загрузка Целевых файлов
- Кнопка: **Добавить файл для изменений**
- Используется для внесения изменений.

### 2. Загрузка файлов-Источников
- Кнопка: **Добавить файл-источник**
- Используются как источники данных.

> **Рекомендация:** используйте минимальное количество файлов-Источников с дублирующимися артикулами, чтобы избежать конфликтов.
> - **Причина:** если один и тот же артикул встречается в нескольких файлах-Источниках, будет использовано значение из первого найденного товара с этим артикулом.

> **Совет:** если у вас несколько прайс-листов **С ОДИНАКОВЫМИ ТОВАРАМИ**, объедините их в один файл перед обработкой, чтобы получить ожидаемый результат.
> - Если у вас нет совпадающих артикулов между файлами, то вы можете использовать несколько файлов-Источников.

---

## Выбор операции

### Перенос цен
- **Галочка:** `Переносить цены`
#### Обязательные поля:
- `Артикул`, `Цена`
- Дополнительно: `АртикулКомплекта`, `ЦенаКомплекта` (в прайс-листе)

> **Обязательно:** если вы переносите значения из прайс-листа, значения должны находиться **под соответствующими столбцами**.

---
### Перенос наличия
- **Галочка:** `Переносить наличие`
#### Обязательные поля:
- `Наличие`
- Дополнительно: `НаличиеКомплекта` (в прайс-листе)

---

### Повышение цен
- **Галочка:** `Повысить цену (Псевдо-скидка)`
- Укажите процент наценки в диапазоне от `1` до `200`.

> **Подробности:** Расценивается как процент. 1 == 101%, 2 == 102%, 99 == 199%, 100 == 100%, 101 == 101%... 200 == 200%, 201 == 201%...
> ввод `0` или `100` - цена не изменится.

> **Подсказка:** если вы хотите увеличить цену на 10%, введите `10` или `110`. Но если вы введете больше 200, у вас спросят подтверждение.

---

### Перенос скидок
- **Галочка:** `Переносить скидку`
#### Обязательные поля:
- `Скидка` (только из магазина в магазин)

> **Важно:** перенос процентов скидки работает таким образом, что **не преобразует 110% в 10%**, а просто **копирует значение из одного столбца в другой.** Будьте внимательны при использовании.

---

### Перенос дат скидок
- **Галочка:** `Переносить дату скидки`
#### Дополнительные поля:
- `скидка от/до` (только из магазина в магазин)

> **Обязательно:** В настройках магазина должен быть указан столбец `ФорматДаты`.
> `ДатаОкончанияСкидки` и `ДатаНачалаСкидки` используются только если они присутствуют в магазине.
> На самом деле нет такого поля как «Дата скидки». Дата берется из столбца в одном магазине и переносится в столбец в другом магазине, если он присутствует.

---

### Поиск отсутствующих артикулов
- **Галочка:** `Найти отсутствующие`
- Позволяет найти артикулы, которые есть в Целевых файлах, но отсутствуют в файлах-Источниках.
- Результат сохраняется в файле `missing.txt` на рабочем столе.

---

### Запуск
- Кнопка: **Старт**
1. Убедитесь, что файлы загружены
2. Установите параметры
3. Нажмите «Старт»
4. Дождитесь сообщения `Готово`

---

## Обязательные условия

- Названия столбцов должны быть правильными (Если это прайс-лист):
    - **Артикул:** `Артикул`, `Article`, `АртикулКомплекта`
    - **Цена:** `Цена`, `Price`, `ЦенаКомплекта`
    - **Наличие:** `Наличие`, `Availability`, `НаличиеКомплекта`

❗Все заголовки должны быть написаны **точно**, без лишних символов, пробелов или ошибок.

</details>

<details>
<summary> Менеджер магазинов </summary>

### Открытие Менеджера магазинов
- `Настройки` -> `Менеджер магазинов`

### Описание окна
- **Слева:** список магазинов с возможностью выбора для редактирования. (Ненужные магазины можно удалить)
- **Кнопка внизу слева:** Позволяет добавлять магазины.
- **Справа:** список доступных столбцов из загруженного файла.
- **В центре:** Поля для названий столбцов, соответствующих различным параметрам (значения берутся из столбца справа).

> **Обязательно:** поскольку программа использует список справа (Все столбцы) для идентификации магазина - оставляйте только те столбцы, которые есть в вашем файле и ВСЕГДА В КАЖДОМ ФАЙЛЕ.
> Столбцы, которые зависят от категории товара (например, `цвет`, `размер`, `материал`, `материал|45234` и т.д.) - будут мешать нормальной работе, поэтому их нужно удалить из списка.

### Назначение
- Позволяет сохранять настройки столбцов для различных магазинов.
- Вы можете добавлять, удалять и редактировать магазины.

> **Обратите внимание:** При сохранении **изменения будут доступны при следующем запуске программы.**

### Добавление магазина
- Кнопка: `Добавить магазин`
- Введите название магазина.
- Нажмите кнопку `Получить заголовки магазина`
- Укажите названия столбцов для артикула, цены, наличия и других параметров, присутствующих в магазине.

</details>

<details>
<summary>Таблица связей товаров</summary>

### Открытие Таблицы связей товаров
- `Таблица связей товаров`

### Описание окна
- **Кнопка: `Добавить новый товар`**
- Таблица со столбцами:
> **Основной (Master)** — основной артикул товара, к которому будут привязаны другие артикулы. **(артикул из прайс-листа)**
> **Связанный артикул (Linked Article)** — артикул, который будет привязан к основному. **(артикул из магазина)** Название столбца — это магазин, в котором используется этот артикул.

> **Внимание:** если у вас несколько магазинов, то для каждого магазина должен быть свой столбец с названием магазина.
> Если ваш артикул в магазине совпадает с артикулом в прайс-листе — вам не нужно добавлять связь.
> Если ваш артикул в конкретном магазине совпадает с артикулом в прайс-листе — добавляйте связи только для тех магазинов, где артикул отличается. (но вы можете добавить для всех магазинов при желании)

</details>

---

## Примеры

### Пример 1

✅ Правильный вид:

| Артикул | Цена | АртикулКомплекта | ЦенаКомплекта |
 |---------|-------|------------------|----------------|
| A001    | 100   | A001-C           | 80             |

❌ Ошибка:

| Артикул | Article | Цена |
 |---------|---------|------|
| A001    |         | 100  |

> В этом случае будет обрабатываться только столбец `Article`. И поскольку у него нет значения
>     - товар не будет найден и обработан.

### Пример 2

✅ Правильный вид:

| Артикул  | Цена    | Наличие | любой | любой   | любой |
 |----------|----------|--------------|-----|-------|-----|
| Product1 | 200      | +            | ... | ...   | ... |
| любой      | Артикул  | Наличие | любой | Цена | любой |
| ...      | product2 | +            | ... | 300   | ... |
| ...      | product3 | +            | ... | 700   | ... |

❌ Ошибка:

| Артикул  | Цена    | Наличие | любой | любой   | любой |
 |----------|----------|--------------|-----|-------|-----|
| Product1 | 200      | +            | ... | ...   | ... |
| любой      | Артикул  | Наличие | любой | Цена | любой |
| ...      | product2 | +            | ... | 300   | ... |
| product3 | 700      | +            | ... | ...   | ... |

> На выходе будет -> Product1 с ценой 200 в наличии, Product2 с ценой 300 в наличии, Product3 - проигнорирован

### Более подробно в инструкции, расположенной в приложении.
`Еще` -> `Инструкция`

---

## Повторение важных моментов

<details>
<summary>Общее</summary>

> - Перепроверяйте результаты после обработки.

> - Следуйте инструкциям ниже.

> - Все файлы Excel должны быть **закрыты** перед началом обработки.

> - Используйте файлы в форматах: `.xlsx`, `.xls`.

> - При возникновении ошибок проверьте правильность заголовков и наличие всех необходимых столбцов.

> - Программа работает **по артикулам**, обязательное точное совпадение, если не указана связь. Даже разница в один символ (например, `K` и `К`) критична.

> - Рекомендуется создавать резервные копии файлов перед обработкой.

> - Программа не поддерживает макросы и сложные формулы в файлах Excel.

> - Обработка больших файлов может занять некоторое время, пожалуйста, наберитесь терпения.

</details>

<details>
<summary> Операции </summary>

> **Рекомендация:** используйте минимальное количество файлов-Источников с дублирующимися артикулами, чтобы избежать конфликтов.
> - **Причина:** если один и тот же артикул встречается в нескольких файлах-Источниках, будет использовано значение из первого найденного товара с этим артикулом.

> **Совет:** если у вас несколько прайс-листов **С ОДИНАКОВЫМИ ТОВАРАМИ**, объедините их в один файл перед обработкой, чтобы получить ожидаемый результат.
> - Если у вас нет совпадающих артикулов между файлами, то вы можете использовать несколько файлов-Источников.

> **Обязательно:** если вы переносите значения из прайс-листа, значения должны находиться **под соответствующими столбцами**. (актуально для прайс-листов, магазины обычно и так придерживаются стандарта)

### Повышение цен
> **Подробности:** Расценивается как процент. 1 == 101%, 2 == 102%, 99 == 199%, 100 == 100%, 101 == 101%... 200 == 200%, 201 == 201%...
> ввод `0` или `100` - цена не изменится.

> **Подсказка:** если вы хотите увеличить цену на 10%, введите `10` или `110`. Но если вы введете больше 200, у вас спросят подтверждение.

### Перенос скидок

> **Важно:** перенос процентов скидки работает таким образом, что **не преобразует 110% в 10%**, а просто **копирует значение из одного столбца в другой.** Будьте внимательны при использовании.

### Перенос дат скидок
> **Обязательно:** В настройках магазина должен быть указан столбец `ФорматДаты`.
> `ДатаОкончанияСкидки` и `ДатаНачалаСкидки` используются только если они присутствуют в магазине.
> На самом деле нет такого поля как «Дата скидки». Дата берется из столбца в одном магазине и переносится в столбец в другом магазине, если он присутствует.

</details>

<details>
<summary>Менеджер магазинов</summary>

> **Обязательно:** поскольку программа использует список справа (Все столбцы) для идентификации магазина - оставляйте только те столбцы, которые есть в вашем файле и ВСЕГДА В КАЖДОМ ФАЙЛЕ.
> Столбцы, которые зависят от категории товара (например, `цвет`, `размер`, `материал`, `материал|45234` и т.д.) - будут мешать нормальной работе, поэтому их нужно удалить из списка.

</details>

<details>
<summary>Таблица связей товаров</summary>

> **Внимание:** если у вас несколько магазинов, то для каждого магазина должен быть свой столбец с названием магазина.
> Если ваш артикул в магазине совпадает с артикулом в прайс-листе — вам не нужно добавлять связь.
> Если ваш артикул в конкретном магазине совпадает с артикулом в прайс-листе — добавляйте связи только для тех магазинов, где артикул отличается. (но вы можете добавить для всех магазинов при желании)

</details>

---

## Контакты

Вопросы/Предложения?
Пишите:
[Telegram](https://t.me/Freid4)
[Email](mailto:f4labs.study@gmail.com)

---

# Отказ от ответственности:
Использование этой программы осуществляется на ваш страх и риск. Автор не несет ответственности за любые убытки или ущерб, возникшие в результате использования программы. Любые ошибки или проблемы, возникшие при использовании программы, не могут быть предъявлены автору в качестве претензий или требований о компенсации. Кроме того, автор не гарантирует, что программа будет работать без сбоев или ошибок и не несет ответственности за любые последствия, возникшие в результате использования программы. Ошибки в программе могут быть исправлены в будущих версиях, но автор не обязан предоставлять поддержку или обновления для программы. Пользователи должны самостоятельно оценивать риски и принимать меры предосторожности при использовании программы. Любые ошибки, связанные с некорректными результатами, являются следствием вашей невнимательности и не могут быть использованы против автора.